#Encodage du texte

Les requêtes XPath sont à effectuer dans le fichier Current_driver.tei.

##Supprimer les styles

*Done :*

* Je supprime l'attribut @style présent sur certains paragraphes (pour indiquer un alignement droit/centré, etc.)
* Je supprime les hi qui servent à autre chose qu'à mettre en exposant. Revoir éventuellement le commit https://github.com/lb42/difdepo/commit/3b36d3d1d16ea117c6fc68f18801dd1da8c6b245 : j'ai supprimé certains hi qui n'étaient pas des exposants, mais il y avait des cas où ce balisage indiquait (me semble-t-il) une entité.
* Je rajoute @rend="sup" à tous les hi (et je corrige manuellement un cas en indice)

*To do :*

* Revoir les occurrences de //hi et supprimer le balisage pour les cas où il ne s'agit ni d'un exposant, ni d'un indice (une cinquantaine d'occurrences : pour les e, er, ème c'est a priori correct, seules les nombres sont ambigus)

*De mon côté :*

* Ajouter <sub>

##Gérer les commentaires et les notes

*Done :*

* J'ajoute @resp="author" sur cinq notes pour les distinguer des notes éditoriales

*To do :*

* Revoir les éléments //note
* Revoir les $$$

On peut insérer une note d'éditeur <note resp="editor"> qui sera affichée comme les notes d'auteur, suivie de la mention "[Note de l'éditeur]"

*De mon côté :*

* Écrire le script pour numéroter les notes
* Ajouter la distinction note d'auteur/éditeur dans l'interface

##del, add, supplied, corr

*Done :*

* J'ajoute add, supplied, choice, sic, corr au schéma

On utilise <add> pour les ajouts.

*Suggestion :*

* Convertir \[.+?\] en <supplied> ou en <choice><sic></sic><corr></corr></choice>

*De mon côté :*

* Transformer <add> en vertical-align:super;
* Gérer supplied, choice


##Éléments vides

*Done :*

* Je supprime les p, persName, orgName, name, title, placeName, term, unclear vides (je n'ai pas vérifié manuellement tous les cas, mais j'ai l'impression que c'était des erreurs de stylage ; vous pouvez vérifier le commit https://github.com/lb42/difdepo/commit/6b0ff142a873912477d5c74adfce0c5c1e9e4658).
* Je laisse les item vides (les usages varient sur la retranscription des items vides)

##Entités

*Done :*

* Je scinde les persName contenant plusieurs initiales //persName[fn:matches(.," ([A-Z]{2,3} ){2,}")]
/6b0ff142a873912477d5c74adfce0c5c1e9e4658 : 31 fichiers corrigés)
* Quand une entité est suivie d'un point, je place le point à l'intérieur des balises (https://github.com/lb42/difdepo/commit/4e4152b3cbabd5655e8f6ba6363717bfd1f9d1a9). Il est plus important que le point d'initial soit systématiquement balisé, plutôt que le point de phrase ne le soit pas. 
* J'ajoute un @ref pour les Oulipiens référencés dans oulipiens.xml sur la base de plusieurs formes possibles pour leur nom : 19697 persName non référencés > 3825

*To do :*

* entités mal balisées
	* Noms de personnes avec plus de 2 espaces (risque de noms de personnes agrégés) : //persName[count(tokenize(., ' '))>2])
	* Toutes les occurrences : //text//persName[not(@ref)]
	* Aperçu de tous les noms : distinct-values(//text//persName[not(@ref)])
	* Nettoyer : 
		* Corriger s'il ne s'agit pas d'un nom de personne
		* Exclure les signes typographiques, les titres, les articles
		* Au plus près d'un format P. Nom, Prénom Nom ou Nom
	* But : 
		* titre de la fiche index
		* association des noms de personne (ne tient pas compte de la typographie, mais les lettres sont discriminantes)
	* Idem pour orgName, name, title, term (vérifier à ce moment-là le problème des imbrications)
	* Pour les imbrications, regarder peut-être les entités qui sont contiguës : //body//(title|name|term|orgName|ref)[following::node()[normalize-space(.) != ''][1][(self::persName) or (self::title) or (self::name) or (self::term) or (self::orgName) or (self::ref)]]

* //text//ref : ajouter @target (URL du dossier dans Gallica, en précisant à quelle page du dossier commence l’élément en question)


##Structure

###p

*Done :*

* Je remplace les p par des lb dans l'incipit "Ouvroir de<lb/> littérature<lb/> potentiel"

*Suggestion :*

* Paragraphe scindé par un saut de page : 2 p à fusionner



###list

####Regroupement

*Done :*

* Correction manuelle sur les fichiers avec des listes contiguës de type différent. https://github.com/lb42/difdepo/commit/ff97e2fa52aabbd946cc536cb865e2c12e613fb7. Listes imbriquées, utilisation de p au lieu de pb, utilisation de list/item au lieu de p/label. Problèmes de numérotation ("9bis"). Listes à fusionner.
* Correction manuelle des fichiers avec des listes scindées par un saut de page. https://github.com/lb42/difdepo/commit/91122eae5ee655477a581eb045daf6ae44cde3ef 

*To do :*

* Listes contiguës (toutes de même type), 42 fichiers : //list[following-sibling::*[1]/name()="list"]
* Listes incomplètes, 135 fichiers : //text//list[count(item)=1]

*Suggestion :*

* Fusionner automatiquement toutes les listes contiguës ? Ça serait parfois pertinent, mais pas toujours...

####Affichage et numérotation

*Done :*

* Je convertis list[not(@type)] en list@type="unordered"
* Je supprime les tirets au début des list@type="unordered"
* Je supprime les nombres au début des list@type="ordered" (il n'y a pas de cas de list@type="ordered" commençant par un tiret, une lettre, etc.). Mais il y a des cas compliqués : http://gallica.bnf.fr/ark:/12148/btv1b10010331s/f1.image. T10010331-1989-10-OJ.xml
* Je laisse les nombres au début des list@type="unordered"
* Je laisse les list[not(@type)] qui commencent souvent par un nombre, un tiret, une lettre

*De mon côté :*

* Supprimer le tiret et les numéros à l'affichage


###label

*To do :*

Vérifier une vingtaine de fichiers avec un style "rubrique" potentiellement envahissant (plusieurs label@type="rubrique" à la suite) :
//*[label][following::*[1]/label]

*Suggestion :*

Il n'y a que 7 p contenant un label et autre chose (dont certains cas où il ne s'agit peut-être pas vraiment d'un label) : //p[label]
Faire de label un style de paragraphe p@rend="label" ?


